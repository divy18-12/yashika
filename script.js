const garden = document.getElementById('garden');const message = document.getElementById('message');const envelopeOverlay = document.getElementById('envelopeOverlay');const music = document.getElementById('bgMusic');const petalsLayer = document.getElementById('petals');const butterfliesLayer = document.getElementById('butterflies');const heartsLayer = document.getElementById('hearts');const confettiLayer = document.getElementById('confetti');function createGarden(){for(let i=0;i<12;i++){const f=document.createElement('div');f.className='flower';const s=document.createElement('div');s.className='stem';const h=260+Math.floor(Math.random()*90);s.style.height='0px';f.style.setProperty('--stem-height',h+'px');f.appendChild(s);for(let j=0;j<4;j++){const p=document.createElement('div');p.className='petal layer'+(j+1);f.appendChild(p);}const pc=document.createElement('div');pc.className='petal center';f.appendChild(pc);garden.appendChild(f);const delay=i*180;s.style.transition='height 1.1s cubic-bezier(.2,.9,.2,1) '+delay+'ms';pc.style.animationDelay=(1800+delay)+'ms';setTimeout(()=>s.style.height=h+'px',50+delay);} }function burstConfettiHearts(x,y,count=28){for(let i=0;i<count;i++){const c=document.createElement('div');c.className='confettiHeart';confettiLayer.appendChild(c);const offsetX=(Math.random()-0.5)*120;const offsetY=(Math.random()-0.5)*40;c.style.left=(x+offsetX)+'px';c.style.top=(y+offsetY)+'px';const dx=(Math.random()-0.5)*300;const dy=-100-Math.random()*300;const rot=(Math.random()-0.5)*720;const dur=1000+Math.random()*1200;c.style.animationDuration=dur+'ms';const start=performance.now();const startLeft=parseFloat(c.style.left);const startTop=parseFloat(c.style.top);function frame(now){const t=(now-start)/dur;if(t>=1){c.remove();return;}const ease=1-Math.pow(1-t,3);c.style.left=(startLeft+dx*ease)+'px';c.style.top=(startTop+dy*ease)+'px';c.style.transform='rotate('+ (rot*ease) +'deg) scale('+(0.6+0.4*ease)+')';requestAnimationFrame(frame);}requestAnimationFrame(frame);} }envelopeOverlay.addEventListener('click',()=>{const env=document.querySelector('.envelope');env.classList.add('open');const rect=env.getBoundingClientRect();burstConfettiHearts(rect.left+rect.width/2,rect.top+rect.height/2,36);setTimeout(()=>{envelopeOverlay.remove();createGarden();setTimeout(()=>document.getElementById('garden').style.opacity=1,300);try{music.currentTime=0;}catch(e){}music.play().catch(()=>{});setInterval(()=>{const petal=document.createElement('div');petal.className='petalFall';petal.style.left=Math.random()*window.innerWidth+'px';petal.style.width=(8+Math.random()*12)+'px';petal.style.height=(8+Math.random()*12)+'px';petal.style.background=['#ffd1dc','#f0d6ff','#eaf6ff'][Math.floor(Math.random()*3)];petalsLayer.appendChild(petal);setTimeout(()=>petal.remove(),6000);},500);setInterval(()=>{const sparkle=document.createElement('div');sparkle.className='sparkle';sparkle.style.left=Math.random()*window.innerWidth+'px';sparkle.style.top=Math.random()*window.innerHeight+'px';document.body.appendChild(sparkle);setTimeout(()=>sparkle.remove(),3000);},900);(function spawnButterflies(){const count=3+Math.floor(Math.random()*3);for(let i=0;i<count;i++){const b=document.createElement('div');b.className='butterfly';const lw=document.createElement('div');lw.className='wing left';const rw=document.createElement('div');rw.className='wing right';b.appendChild(lw);b.appendChild(rw);butterfliesLayer.appendChild(b);const startX=-60-Math.random()*200;const startY=window.innerHeight*(0.5+Math.random()*0.3);b.style.left=startX+'px';b.style.top=startY+'px';const endX=window.innerWidth+60;const amplitudeY=120+Math.random()*80;const startTime=performance.now();const dur=10000+Math.random()*8000; (function frame(now){const t=(now-startTime)/dur;if(t>=1){b.remove();return;}const x=startX+(endX-startX)*t;const y=startY-Math.sin(t*Math.PI*2)*amplitudeY;b.style.left=x+'px';b.style.top=y+'px';const wingAngle=Math.sin(t*Math.PI*6)*12;lw.style.transform='rotate('+(-wingAngle)+'deg)';rw.style.transform='rotate('+wingAngle+'deg)';requestAnimationFrame(frame);})(performance.now());}setTimeout(spawnButterflies,4000+Math.random()*3000)})();(function spawnHearts(){const h=document.createElement('div');h.className='heartGlow';const left=20+Math.random()*60;h.style.left=left+'%';h.style.bottom='40px';heartsLayer.appendChild(h);const dur=3800+Math.random()*1600;h.style.animation='heartFloat '+dur+'ms linear forwards';setTimeout(()=>h.remove(),dur+200);setTimeout(spawnHearts,900+Math.random()*900)})();setTimeout(()=>{document.getElementById('message').style.opacity=1},3800);},520);});